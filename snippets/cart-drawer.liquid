<style>
  .cart-drawer.active .cart-drawer__overlay {
    opacity: 1;
  }

  .cart-drawer.active .cart-drawer__inner {
    transform: translateX(0);
  }

  .cart-drawer.animate {
    visibility: visible;
    opacity: 1;
  }

  .cart-drawer.active {
    visibility: visible;
    opacity: 1;
  }

  .cart-drawer__item.is-loading {
    opacity: 0.6;
    pointer-events: none;
    transition: opacity 0.2s ease-in-out;
  }

  .quantity__input:focus {
    border: none;
    outline: none;
  }

  .cart-drawer__item-details {
    width: calc(100% - 100px - 16px);
  }

  .cart-drawer__item {
    opacity: 0;
    transform: translateY(20px);
    transition: opacity 0.4s ease-out, transform 0.4s ease-out;
  }

  .cart-drawer.active .cart-drawer__item {
    opacity: 1;
    transform: translateY(0);
  }

  .cart-drawer__item.is-loading {
    opacity: 0.6 !important;
    pointer-events: none;
    transition: opacity 0.2s ease-in-out !important;
    transform: translateY(0) !important;
  }

  .cart-drawer.active .cart-drawer__item:nth-child(1) { transition-delay: 0.1s; }
  .cart-drawer.active .cart-drawer__item:nth-child(2) { transition-delay: 0.15s; }
  .cart-drawer.active .cart-drawer__item:nth-child(3) { transition-delay: 0.2s; }
  .cart-drawer.active .cart-drawer__item:nth-child(4) { transition-delay: 0.25s; }
  .cart-drawer.active .cart-drawer__item:nth-child(5) { transition-delay: 0.3s; }
  .cart-drawer.active .cart-drawer__item:nth-child(6) { transition-delay: 0.35s; }
  .cart-drawer.active .cart-drawer__item:nth-child(7) { transition-delay: 0.4s; }
  .cart-drawer.active .cart-drawer__item:nth-child(8) { transition-delay: 0.45s; }

  .cart-drawer__item.is-loading {
    transition-delay: 0s !important;
  }
</style>

<cart-drawer id="cart-drawer" class="cart-drawer fixed right-0 w-full z-1000 invisible opacity-0 transition-transform">
  <div class="cart-drawer__overlay overlay absolute top-0 left-0 w-full h-full cursor-pointer opacity-0 transition-transform"></div>
  <div class="cart-drawer__inner pt-20 pr-16 pb-20 pl-16 flex flex-col gap-16 absolute top-0 right-0 w-full h-full transition-transform translate-x-full w-430 sm:w-367 bg-bg">
    
    <!-- Header -->
    <div class="cart-drawer__header pb-12 border-top-none border-right-none border-left-none border-b border-solid border-color flex items-center justify-between flex-shrink">
      <h2 class="cart-drawer__title ff-general-sans fw-400 fs-17-lh-24-ls-0">
        {{ 'sections.cart.title' | t }} ({{ cart.item_count }})
      </h2>
      <button class="cart-drawer__close bg-transparent border-none w-28 h-28 cursor-pointer" type="button" aria-label="{{ 'accessibility.close' | t }}">
        <svg width="17" height="16" viewBox="0 0 17 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M0.683594 15.5078C0.263672 15.0977 0.273438 14.375 0.683594 13.9746L6.68945 7.95898L0.683594 1.95312C0.273438 1.55273 0.263672 0.839844 0.683594 0.410156C1.10352 -0.00976562 1.81641 0 2.22656 0.410156L8.23242 6.41602L14.2383 0.410156C14.6582 0 15.3516 0 15.7812 0.419922C16.2109 0.830078 16.2012 1.54297 15.791 1.95312L9.78516 7.95898L15.791 13.9746C16.2012 14.3848 16.2012 15.0879 15.7812 15.5078C15.3613 15.9375 14.6582 15.9277 14.2383 15.5176L8.23242 9.51172L2.22656 15.5176C1.81641 15.9277 1.11328 15.9277 0.683594 15.5078Z" fill="#FB6F92"/>
        </svg>
      </button>
    </div>

    <!-- Contents -->
    <div class="cart-drawer__contents flex-1 flex flex-col overflow-hidden">
      {% if cart != empty %}
        <div class="cart-drawer__error hidden mb-16">
          <span class="cart-drawer__error-message flex items-start-priority error-text"></span>
        </div>

        <!-- Items + Note -->
        <div class="cart-drawer__items flex-auto min-h-0 flex flex-col">
          <div class="cart-drawer__items-list flex-auto overflow-y-auto flex flex-col relative pb-0 scrollbar-w-8 scrollbar-track-none scrollbar-thumb-brand scrollbar-thumb-brand-hover">
            {% for item in cart.items %}
              <div class="cart-drawer__item flex gap-16 p-12 border-top-none border-right-none border-left-none border-b border-solid border-color" id="CartDrawer-Item-{{ item.index | plus: 1 }}">
                <div class="cart-drawer__item-media media block relative w-100 h-116">
                  {% if item.image %}
                    {%- capture sizes %}{% render 'sizes-attribute', grid: true, min: 1, sm: 1, lg: 1, xl: 1 %}{% endcapture -%}
                    {% render 'image',
                      image: item.image,
                      widths: '100, 100, 100, 100',
                      src_width: 100,
                      sizes: sizes,
                      class: 'img-fit w-full',
                      quality: 1
                    %}
                  {% endif %}
                </div>
                <div class="cart-drawer__item-details flex flex-col gap-8">
                  <a href="{{ item.url }}" class="cart-drawer__item-title fw-400 fs-12-lh-16-ls-0_072 text-primary hover-brand">
                    {{ item.product.title | escape }}{% if item.product.has_only_default_variant == false %}{% for option in item.options_with_values %} | {{ option.value }}{% endfor %}{% endif %}
                  </a>
                  <div class="flex flex-col gap-8">
                    <div class="cart-drawer__item-pricing">
                      <div class="cart-drawer__item-price-wrapper">
                        {% render "cart-price", item: item %}
                      </div>
                    </div>
                    <div class="cart-drawer__item-quantity flex gap-12 items-center pt-4 pb-4">
                      {% render "cart-quantity-picker", item: item %}
                    </div>
                  </div>
                  {% render "cart-line-item-buttons", item: item %}
                </div>
              </div>
            {% endfor %}

            <!-- Cart Note inside scrollable -->
            <cart-note class="cart-note block pt-16 w-full mt-auto shrink-0">
              <div class="cart-note__wrapper">
                {% assign label = 'sections.cart.note_label' | t %}
                {% render "textarea", id: "{{ id }}", name: "note", label: label %}
              </div>
            </cart-note>
          </div>
        </div>
      {% else %}
        <div class="h-308 flex justify-center items-center cart-drawer__items flex-1 overflow-y-auto pb-0 scrollbar-w-8 scrollbar-track-none scrollbar-thumb-brand scrollbar-thumb-brand-hover">
          <img 
            src="{{ 'empty-cart.jpg' | asset_url }}"
            width="auto"
            height="auto"
            loading="lazy"
            class="object-contain h-full"
          />
        </div>
      {% endif %}

      <!-- Footer (always visible) -->
      <div class="cart-drawer__footer flex flex-col gap-16 pt-16">
        {% render "cart-summary", item: item, cart_note_id: "CartDrawer-Note" %}

        <div class="cart-drawer__cta flex gap-16 sm:flex-col">
          <a href="{{ routes.cart_url }}" type="submit" class="button button--outline w-50pct sm:w-full h-48 flex justify-center items-center fs-16-lh-100pct-ls-0" name="add" form="cart" 
            {% if cart == empty %}disabled{% endif %}>
            {{ 'sections.cart.view_cart' | t }}
          </a>

          <a href="/checkout" class="button button--solid w-50pct sm:w-full h-48 flex items-center justify-center fs-16-lh-100pct-ls-0">
            {{ 'sections.cart.checkout' | t }}
          </a>
        </div>
      </div>
    </div>
  </div>

  <form action="{{ routes.cart_url }}" method="post" id="cart" novalidate class="cart">
    <div id="cart-errors" class="form__message"></div>
  </form>
</cart-drawer>
