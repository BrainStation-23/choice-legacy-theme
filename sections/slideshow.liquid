<slideshow-component
  class="slideshow slideshow-{{ section.id }} block relative overflow-hidden pt-12 pb-12 sm:pt-0 sm:pb-0"
  data-autoplay="{{ section.settings.enable_autoplay }}"
  data-autoplay-delay="{{ section.settings.autoplay_delay | times: 1000 }}"
  data-pause-on-hover="{{ section.settings.pause_on_hover }}"
  data-show-partial-slides="true"
  data-gap="16"
>
  <div class="slideshow-container mt-0 mr-auto mb-0 ml-auto">
    <div class="swiper-container relative w-full h-410 overflow-visible sm:h-186">
      <div class="swiper-wrapper flex {% if section.blocks.size <= 1 %}translate-none{% endif %}">
        {% for block in section.blocks %}
          {%- liquid
            assign img = block.settings.image
            assign m_img = block.settings.mobile_image
          -%}
          <div
            class="swiper-slide rounded-6 sm:rounded-0 relative overflow-hidden transition-transform {% unless block.settings.mobile_image %}slide-no-mobile-image{% endunless %} {% if section.blocks.size <= 1 %}w-80pct sm:w-full-priority m-0-auto-priority{% endif %}"
            {{ block.shopify_attributes }}
            data-block-id="{{ block.id }}"
            data-block-type="{{ block.type }}"
            id="shopify-block-{{ block.id }}"
          >
            {% if block.settings.video_url != blank %}
              {% if block.settings.link != blank %}
                <a
                  href="{{ block.settings.link }}"
                  {% if block.settings.link_target %}
                    target="_blank" rel="noopener"
                  {% endif %}
                >
              {% endif %}
              <video
                class="slide-video w-full h-full object-cover block"
                {% if block.settings.video_autoplay %}
                  autoplay
                {% endif %}
                {% if block.settings.video_muted %}
                  muted
                {% endif %}
                {% if block.settings.video_loop %}
                  loop
                {% endif %}
                {% if block.settings.video_controls %}
                  controls
                {% endif %}
                preload="metadata"
                playsinline
              >
                <source src="{{ block.settings.video_url }}" type="video/mp4">
                Your browser does not support the video tag.
              </video>
              {% if block.settings.link != blank %}</a>{% endif %}
            {% elsif block.settings.image != blank %}
              {% if block.settings.link != blank %}
                <a
                  href="{{ block.settings.link }}"
                  {% if block.settings.link_target %}
                    target="_blank" rel="noopener"
                  {% endif %}
                >
              {% endif %}
              {%- capture sizes %}{% render 'sizes-attribute' %}{% endcapture -%}

              {%- render 'image-desktop-and-mobile',
                class: 'img-fit',
                desktop_image: img,
                mobile_image: m_img,
                src_width_mobile: 980,
                widths_mobile: '480, 980, 1200, 1400',
                src_width_desktop: 1400,
                widths_desktop: '480, 980, 1200, 1400, 1600, 1920, 2560, 3200',
                lazy_load: false,
                fetchpriority: 'high',
                sizes: sizes,
                block: block
              -%}
              {% if block.settings.link != blank %}</a>{% endif %}
            {% else %}
              {% assign image_number = forloop.index0 | modulo: 2 | plus: 1 %}
              {{ 'lifestyle-' | append: image_number | placeholder_svg_tag: 'placeholder-svg block sm:hidden' }}
            {% endif %}

            {% if block.settings.video_url != blank %}
              {% if block.settings.link != blank %}
                <a
                  href="{{ block.settings.link }}"
                  {% if block.settings.link_target %}
                    target="_blank" rel="noopener"
                  {% endif %}
                >
              {% endif %}
              <video
                class="slide-video hidden sm:block"
                {% if block.settings.video_autoplay %}
                  autoplay
                {% endif %}
                {% if block.settings.video_muted %}
                  muted
                {% endif %}
                {% if block.settings.video_loop %}
                  loop
                {% endif %}
                {% if block.settings.video_controls %}
                  controls
                {% endif %}
                preload="metadata"
                playsinline
              >
                <source src="{{ block.settings.video_url }}" type="video/mp4">
                Your browser does not support the video tag.
              </video>
              {% if block.settings.link != blank %}</a>{% endif %}
            {% elsif img != blank %}
              {% if block.settings.link != blank %}
                <a
                  href="{{ block.settings.link }}"
                  {% if block.settings.link_target %}
                    target="_blank" rel="noopener"
                  {% endif %}
                >
              {% endif %}
              {%- capture sizes %}{% render 'sizes-attribute' %}{% endcapture -%}

              {%- render 'image-desktop-and-mobile',
                class: 'img-fit',
                desktop_image: img,
                mobile_image: m_img,
                src_width_mobile: 980,
                widths_mobile: '480, 980, 1200, 1400',
                src_width_desktop: 1400,
                widths_desktop: '480, 980, 1200, 1400, 1600, 1920, 2560, 3200',
                lazy_load: lazy_load,
                fetchpriority: fetchpriority,
                sizes: sizes,
                block: block
              -%}
              {% if block.settings.link != blank %}</a>{% endif %}
            {% else %}
              {{ 'lifestyle-1' | placeholder_svg_tag: 'placeholder-svg hidden sm:block' }}
            {% endif %}

            {% if block.settings.title != blank
              or block.settings.description != blank
              or block.settings.button_text != blank
            %}
             {% liquid
               assign slide_content_cls = 'left-40 text-left'
               if block.settings.content_alignment == "right"
                assign slide_content_cls = 'right-40 text-right'
               elsif block.settings.content_alignment == "center"
                assign slide_content_cls = 'left-50pct text-center'
               endif

             %}
              <div class="slide-content flex flex-col gap-10 md:max-w-300 sm:pt-0 sm:pr-15 sm:pb-0 sm:pl-15 absolute top-50pct translate-y--50 z-2 max-w-400 pt-0 pr-20 pb-0 pl-20 {% if block.settings.show_card %}card bg-bg backdrop-blur-10 rounded-12 p-30 sm:p-20{% endif %} align-{{ block.settings.content_alignment | default: 'left' }} {{ slide_content_cls }}">
                {% if block.settings.title != blank %}
                  <h3 class="slide-title fs-36-lh-40-ls-0 sm:fs-21-lh-24-ls-1_2pct">{{ block.settings.title }}</h3>
                {% endif %}

                {% if block.settings.description != blank %}
                  <p class="slide-description fs-16-lh-24-ls-0">{{ block.settings.description }}</p>
                {% endif %}
              </div>
            {% endif %}
          </div>
        {% endfor %}
      </div>
    </div>

    {% if section.blocks.size > 1 %}
      {% render 'nav-button', cls: 'slideshow-nav-button-prev left-10p-52 lg:left-10p-52 md:left-11p-52 sm:left-8', icon_cls: 'icon-arrow-left' %}

      {% render 'nav-button', cls: 'slideshow-nav-button-next right-10p-52 lg:right-10p-52 md:right-11p-52 sm:right-8' %}
    {% endif %}
  </div>
</slideshow-component>

{% schema %}
{
  "name": "Slideshow",
  "tag": "section",
  "class": "section",
  "disabled_on": {
    "groups": ["header", "footer"]
  },
  "settings": [
    {
      "type": "header",
      "content": "Autoplay Settings"
    },
    {
      "type": "checkbox",
      "id": "enable_autoplay",
      "label": "Enable autoplay",
      "default": true,
      "info": "Automatically advance slides"
    },
    {
      "type": "range",
      "id": "autoplay_delay",
      "min": 2,
      "max": 10,
      "step": 0.5,
      "unit": "s",
      "label": "Autoplay delay",
      "default": 4,
      "info": "Time between slide transitions"
    },
    {
      "type": "checkbox",
      "id": "pause_on_hover",
      "label": "Pause autoplay on hover",
      "default": true,
      "info": "Pause slideshow when mouse hovers over it"
    }
  ],
  "blocks": [
    {
      "type": "slide",
      "name": "Slide",
      "limit": 10,
      "settings": [
        {
          "type": "header",
          "content": "Video Settings"
        },
        {
          "type": "url",
          "id": "video_url",
          "label": "Video URL",
          "info": "Video will take priority over image if both are set. Use MP4 format for best compatibility."
        },
        {
          "type": "checkbox",
          "id": "video_autoplay",
          "label": "Autoplay video",
          "default": true,
          "info": "Videos must be muted to autoplay in most browsers"
        },
        {
          "type": "checkbox",
          "id": "video_muted",
          "label": "Mute video",
          "default": true,
          "info": "Required for autoplay to work"
        },
        {
          "type": "checkbox",
          "id": "video_loop",
          "label": "Loop video",
          "default": true
        },
        {
          "type": "checkbox",
          "id": "video_controls",
          "label": "Show video controls",
          "default": false,
          "info": "Display play/pause controls"
        },
        {
          "type": "header",
          "content": "Images"
        },
        {
          "type": "image_picker",
          "id": "image",
          "label": "Desktop Image",
          "info": "Recommended size: 1200x400px. Will be used as fallback if no video is set."
        },
        {
          "type": "image_picker",
          "id": "mobile_image",
          "label": "Mobile Image (Optional)",
          "info": "Recommended size: 800x300px. If not provided, desktop image will be used."
        },
        {
          "type": "header",
          "content": "Link Settings"
        },
        {
          "type": "url",
          "id": "link",
          "label": "Slide Link (Optional)",
          "info": "Makes the entire slide clickable"
        },
        {
          "type": "checkbox",
          "id": "link_target",
          "label": "Open link in new tab",
          "default": false
        },
        {
          "type": "header",
          "content": "Content Settings"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Slide Title",
          "placeholder": "Enter slide title..."
        },
        {
          "type": "textarea",
          "id": "description",
          "label": "Slide Description",
          "placeholder": "Enter slide description..."
        },
        {
          "type": "checkbox",
          "id": "show_card",
          "label": "Show content in card container",
          "default": false,
          "info": "Adds a semi-transparent background behind the content"
        },
        {
          "type": "select",
          "id": "content_alignment",
          "label": "Content alignment",
          "options": [
            {
              "value": "left",
              "label": "Left"
            },
            {
              "value": "center",
              "label": "Center"
            },
            {
              "value": "right",
              "label": "Right"
            }
          ],
          "default": "left"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Slideshow",
      "blocks": [
        {
          "type": "slide",
          "settings": {}
        },
        {
          "type": "slide",
          "settings": {}
        },
        {
          "type": "slide",
          "settings": {}
        }
      ]
    }
  ]
}
{% endschema %}
